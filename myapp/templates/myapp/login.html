{% load static %}
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="{% static 'myapp/css/login.css' %}" />
    <title>DeMiAインターン</title>
</head>
<body>
<header>
    <div class="header-container">
        <h1 class="header-container__title">ログイン</h1>
    </div>
</header>

<main>
    <form method="post">
        {% csrf_token %}
        {% if not confirmed_username %}
            <table>
                <tr>
                    <td>{{ form.username.label_tag }}</td>
                    <td>{{ form.username }}</td>
                </tr>
            </table>
            <div class="button-wrapper">
                <button type="submit" name="send_code" class="submit-button">認証コードをメールで送信</button>
            </div>
        {% else %}
            <p>ユーザー名: <strong>{{ confirmed_username }}</strong></p>
            <input type="hidden" name="username" value="{{ confirmed_username }}">

            <form method="post">
                {% csrf_token %}
                <input type="hidden" name="clear_username" value="true">
                <button type="submit" class="submit-button">ユーザー名を再入力する</button>
            </form>
        {% endif %}
    </form>

    {% block content %}

    <form method="post">
        {% csrf_token %}
        {% if confirmed_username %}
            <input type="hidden" name="username" value="{{ confirmed_username }}">
        {% endif %}
        <table>
            <tr>
                <td>{{ form.password.label_tag }}</td>
                <td>{{ form.password }}</td>
            </tr>
            <tr>
                <td>{{ form.code_form.label_tag }}</td>
                <td>{{ form.code_form }}</td>
            </tr>
        </table>

        <input type="hidden" name="next" value="friends">
        <div class="button-wrapper">
            <input type="submit" value="login" class="submit-button"/>
        </div>


        {% if messages %}
            <div class="messages">
                {% for message in messages %}
                    <p class="{{ message.tags }}">{{ message }}</p>
                {% endfor %}
            </div>
        {% endif %}

<!-- 
        {% if form.errors %}
            <div class="form-errors">
                <h3>フォームのエラー内容:</h3>
                <ul>
                    {% for field, errors in form.errors.items %}
                        <li><strong>{{ field }}:</strong> {{ errors }}</li>
                    {% endfor %}
                </ul>
            </div>
        {% endif %} -->
    </form>
    {% endblock %}
</main>
</body>
</html>
