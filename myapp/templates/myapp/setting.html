{% extends 'myapp/base.html' %}

{% block content %}
    
    {% if not setting_done %}
    <form method="post" action="{% url 'setting' %}" enctype="multipart/form-data">
        <table>
            {% for field in setting_form %}
              <tr>
                <td>{{ field.label_tag }}</td>
                <td>{{ field }}</td>
              </tr>
            {% endfor %}
            <tr>
                <td>
                    現在の画像
                    <br>
                    {% if user_img.image %}
                        <img src="{{ user_img.image.url }}" alt="" width="200">
                    {% else %}
                        なし
                    {% endif %}
                </td>
            </tr>
            <tr>
                <td>{{ image_setting_form.image.label_tag }}</td>
                <td>{{ image_setting_form.image }}</td>
            </tr>
        </table>
        {% csrf_token %}
        <button type="submit">変更</button>
        {# エラーメッセージを表示 #}
        {% if setting_form.errors %}
            {% for field in setting_form %}
                {% for error in field.errors %}
                    <p>{{ error }}</p>
                {% endfor %}
             {% endfor %}
        {% endif %}
        {% if image_setting_form.errors %}
            {% for error in image_setting_form.image.errors %}
                <p>{{ error }}</p>
            {% endfor %}
        {% endif %}
    </form>    
    {% else %}
    変更完了
    <a href="{% url 'index' %}">indexへ</a>
    {% endif %}
        
{% endblock content %}S