{% extends 'myapp/base.html' %}
{% load static %}

{% block extra_style %}
<link rel="stylesheet" type="text/css" href="{% static 'myapp/css/friends.css' %}">
{% endblock %}

{% block header-title %}友達{% endblock %}

{% block content %}
<div class="find_form">
    <form action="{% url 'friends' %}" method="POST">
    {% csrf_token %}
        <span class="form_input">
            <p>{{ form.find }}</p>
            <input type="submit" value="search">
        </span>
    </form>
</div>

<div class="all_friends">
    {% for friend in log_exist_friends %}

    <div class="friend">
        <a href="{% url 'talk_room' friend.id %}">
            <img src="/media/{{ friend.img }}" alt="アイコン" width="30vw" height="30vh">
            <span class="username">{{ friend }}</span>
            {% for latest_msg in latest_msgs %}
                {% if latest_msg.send_to == friend or latest_msg.send_from == friend %}
                    <span class="message">{{ latest_msg.message }}</span>
                    <span class="date">{{ latest_msg.posted_date|date:"n/j, G:i" }}</span>
                {% endif %}
            {% endfor %}
        </a>
    </div>
    {% endfor %}

    {% for friend in no_log_friends %}
    <div class="friend">
        <a href="{% url 'talk_room' friend.id %}">
            <img src="/media/{{ friend.img }}" alt="アイコン" width="30vw" height="30vh">
            <span class="username">{{ friend }}</span>
        </a>
    </div>
    {% endfor %}

</div>

{% endblock %}
