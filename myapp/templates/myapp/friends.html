{% extends 'myapp/base.html' %}
{% load static %}

{% block extra_style %}
<link rel="stylesheet" type="text/css" href="{% static 'myapp/css/friends.css' %}">
{% endblock %}

{% block header-title %}友達{% endblock %}

{% block content %}
<div class="find_form">
    <form action="{% url 'friends' %}" method="POST">
    {% csrf_token %}
        <span class="form_input">
            <p>{{ form.find }}</p>
            <input type="submit" value="search">
        </span>
    </form>
</div>

<div class="all_friends">
    <div class="friend">
        {% if me.img %}
        <img src="/media/{{ me.img }}" alt="icon" width="30vw" height="30vh">
        {% else %}
        <img src="/media/img/upload/person.png" alt="icon" width="30vw" height="30vw">
        {% endif %}
        <span class="username">{{ me.username }}</span>

    </div>
    {% for friend in page_obj %}

    <div class="friend">
        <a href="{% url 'talk_room' friend.username %}" id="room-name-submit">
            {% if friend.img %}
            <img src="/media/{{ friend.img }}" alt="icon" width="30vw" height="30vh">
            {% else %}
            <img src="/media/img/upload/person.png" alt="icon" width="30vw" height="30vw">
            {% endif %}
            <span class="username">{{ friend|truncatechars:12 }}</span>
            {% if friend.unread_msg_num %}
                <span class="unread_message">{{ friend.unread_msg_num }}</span>
            {% endif %}
            <span class="message">{{ friend.latest_msg|safe|truncatechars:15 }}</span>
            <span class="date">{{ friend.latest_msg_posted_date|date:"n/j, G:i" }}</span>
        </a>
    </div>
    {% endfor %}

    <div class="pagination">
        <span class="step_links">
            <!-- <ul class="page_link"> -->
            {% if page_obj.has_previous %}
                <li class="page-item"><a href="?page=1">&laquo; Top</a></li>
                <li class="page-item"><a href="?page={{ page_obj.previous_page_number }}">previous</a></li>
            {% endif %}

            {% for num in page_obj.paginator.page_range %}
                {% if page_obj.number == num %}
                    <li class="page-item">{{ num }}</li>
                {% else %}
                    <li class="page-item"><a href="?page={{ num }}">{{ num }}</a></li>
                {% endif %}
            {% endfor %}

            {% if page_obj.has_next %}
                <li class="page-item"><a href="?page={{ page_obj.next_page_number }}">next</a></li>
                <li class="page-item"><a href="?page={{ page_obj.paginator.num_pages }}">last &raquo;</a></li>
            {% endif %}
            <!-- </ul> -->
            </span>
    </div>


</div>
{% endblock %}
{% block script %}
<script>
    document.querySelector('#room-name-submit').onclick = function (e) {
        var roomName = document.querySelector('#room-name-input').value;
    };
</script>
{% endblock %}
